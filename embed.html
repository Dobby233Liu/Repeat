<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<style>
			p{margin:0 !important;}
			a{text-decoration: none;}
			a:hover{text-decoration: none;}
			.voy {
				height: 20px !important;
				position: relative;
				top: -2px;
				left: -3px;
				margin-right: -36px;
			}
		</style>
		<title>人类本质</title>
		<link rel="stylesheet" href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
		<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.slim.min.js"></script>
	</head>
	<body id="body">
		<div style="width:320px;height:30px;background-color:#22629E;color:white;font-size:15px;line-height:30px">
			<b><i>&nbsp;&nbsp;&nbsp;<a style="color:white" href="./" target="_blank">人类的本质</a></i></b>&nbsp;&nbsp;&nbsp;<a onclick="document.getElementById('body').style.display='none';" href="#" style="color:white;font-weight:bold;margin-right:5px; float:right;">✖</a>
		</div>

		<div style="width:320px;height:400px;overflow:hidden;background-color:#f0f0f0">
			<div id="chat" style="width:314px;height:360px;margin-left:2px;margin-top:2px;resize:none;background:white;overflow:scroll;border: 1px solid #CCC;-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);-webkit-transition: border linear 0.2s, box-shadow linear 0.2s;-moz-transition: border linear 0.2s, box-shadow linear 0.2s;-o-transition: border linear 0.2s, box-shadow linear 0.2s;transition: border linear 0.2s, box-shadow linear 0.2s;margin-bottom:5px;">
			</div>
			<input id="chattext" type="text" style="margin-left:2px;width:242px;" onkeypress="handleKeyPress(event,this.form)"/><button onclick="addNewText()" style="margin-top:-10px;" class="btn">发送</button>
		</div>

		<script>
			function addNewRepeat(message){
				if (message.indexOf("本质") > -1 || message.indexOf("nature") > -1 || (message.indexOf("ben") > -1 && message.indexOf("zhi") > -1)){
					if ((message.indexOf("ben") > -1 && message.indexOf("zhi") > -1)){
						message = "fu du jier";
					} else if (message.indexOf("nature") > -1) {
						message = "repeater";
					} else {
						message = "复读机";
					}
				}
				var chat = document.getElementById("chat");
				var myColor = "blue";
				var name = "[一个人]：";
				document.getElementById("chattext").value = "";
				chat.innerHTML += "<p style='color:" + myColor + "'>" + name + message + "</p>";
				chat.scrollTop = chat.scrollHeight;
			}
			function repeat(message, times){
				for(var i=0; i<times; i++){
					setTimeout(() => addNewRepeat(message), parseInt(1500 * Math.random() + 35));
				}
			}
			function addNewText(origin){
				var message = $('<div/>').text(document.getElementById("chattext").value).html();
				repeat(message, parseInt(5 * Math.random()));
				var chat = document.getElementById("chat");
				var myColor = "red";
				var name = "你：";
				document.getElementById("chattext").value = "";
				chat.innerHTML += "<p style='color:" + myColor + "'>" + name + message + "</p>";
				chat.scrollTop = chat.scrollHeight;
			}
			function handleKeyPress(e,form){
			  var key = e.keyCode || e.which;
			  if (key == 13) addNewText(0);
			}
		</script>
	</body>
</html>